MBR Partition Table Analyzer (Python)

Overview

This Python script is a specialized forensic utility designed to parse the Master Boot Record (MBR) of a raw disk image. It was developed for Task 1 of the forensic investigation (KH5036CMD) to verify the disk structure and automatically identify the correct starting sector of the target partition (Partition 2) for mounting and analysis.

Features

The script performs the following automated analyses:

MBR Parsing: Reads the first 512 bytes of the disk image to locate the partition table.

Partition Enumeration: Iterates through the four primary partition entries defined in the MBR.

Data Decoding: Uses the struct library to unpack binary data into human-readable fields:

Status: Identifies Bootable vs. Non-Bootable partitions.

Type: Extracts the file system type code (e.g., 0x7 for NTFS).

Start Sector: Calculates the exact LBA offset.

Size: Displays total sectors for capacity verification.

Target Highlighting: Automatically flags Partition 2, providing the specific start sector required for the coursework task.

- Prerequisites

Python 3.x installed on your system.

No external libraries required (Built using standard os and struct modules).

- Usage

Step 1: Setup

Place the script (mbr_analyzer.py) in the same directory as your forensic disk image.

Step 2: Configuration

By default, the script looks for a file named "CW Image.dd". If your image has a different name, edit this line in the code:

image_filename = "CW Image.dd"


Step 3: Run the Script

Execute the script via your terminal or command prompt:

python mbr_analyzer.py


- Output Example

The script outputs a clean table to the console:

[*] Analyzing Partition Table for: CW Image.dd
-----------------------------------------------------------------
Part  Status      Type       Start Sector    Size (Sectors)
-----------------------------------------------------------------
1     Bootable    0x7        2048            204800
2     Non-Boot    0x7        206848          41734144
    [!] NOTE: Task requires focus on Partition 2 (Start: 206848)


- Code Structure

The code logic is straightforward:

f.read(512): Reads the Master Boot Record.

seek(446): Jumps to the partition table offset.

struct.unpack: Decodes the 16-byte entries using the format string <B 3x B 3x I I (Little Endian, Byte, Skip 3, Byte, Skip 3, Int, Int).

- Disclaimer

This tool is intended for educational and authorized forensic analysis purposes only. Always ensure you have the legal right to analyze the data you are processing.

- Author
"AhmedMoamen.61"

[Your Name]
Digital Forensics Student
